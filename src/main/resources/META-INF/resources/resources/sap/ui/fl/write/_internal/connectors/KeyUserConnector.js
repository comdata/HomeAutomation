/*
 * ! OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/merge","sap/ui/fl/write/connectors/BaseConnector","sap/ui/fl/apply/_internal/connectors/KeyUserConnector","sap/ui/fl/apply/_internal/connectors/Utils","sap/ui/fl/write/_internal/connectors/Utils","sap/ui/fl/library","sap/base/util/restricted/_pick"],function(m,B,A,a,W,f,_){"use strict";var P="/flex/keyuser";var b="/v1";var R={CHANGES:P+b+"/changes/",SETTINGS:P+b+"/settings",TOKEN:P+b+"/settings"};function c(p){if(p.flexObject){p.fileName=p.flexObject.fileName;}var w=a.getUrl(R.CHANGES,p);delete p.fileName;var t=a.getUrl(R.TOKEN,p);var r=W.getRequestOptions(A,t,p.flexObjects||p.flexObject,"application/json; charset=utf-8","json");return W.sendRequest(w,p.method,r);}var K=m({},B,{xsrfToken:null,layers:[f.Layer.CUSTOMER],reset:function(p){var d=["reference","appVersion","generator"];var e=_(p,d);if(p.selectorIds){e.selector=p.selectorIds;}if(p.changeTypes){e.changeType=p.changeTypes;}delete p.reference;var r=a.getUrl(R.CHANGES,p,e);var t=a.getUrl(R.SETTINGS,p);var o=W.getRequestOptions(A,t);return W.sendRequest(r,"DELETE",o);},write:function(p){p.method="POST";return c(p);},update:function(p){p.method="PUT";return c(p);},remove:function(p){var d={namespace:p.flexObject.namespace};p.fileName=p.flexObject.fileName;var D=a.getUrl(R.CHANGES,p,d);delete p.fileName;var t=a.getUrl(R.TOKEN,p);var r=W.getRequestOptions(A,t,undefined,"application/json; charset=utf-8","json");return W.sendRequest(D,"DELETE",r);},loadFeatures:function(p){var F=a.getUrl(R.SETTINGS,p);return a.sendRequest(F).then(function(r){return r.response;});}});return K;},true);
