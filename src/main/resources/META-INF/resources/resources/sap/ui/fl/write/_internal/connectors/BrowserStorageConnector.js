/*
 * ! OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/merge","sap/ui/fl/write/connectors/BaseConnector","sap/ui/fl/apply/_internal/connectors/BrowserStorageUtils"],function(m,B,a){"use strict";function s(p,c){var d=true;if(p.selectorIds){if(c.selector){d=p.selectorIds.indexOf(c.selector.id)>-1;}else{d=false;}}if(d&&p.changeTypes){d=p.changeTypes.indexOf(c.changeType)>-1;}return d;}var b=m({},B,{oStorage:undefined,layers:["ALL"],write:function(p){p.flexObjects.forEach(function(f){var c=a.createFlexObjectKey(f);var C;C=JSON.stringify(f);this.oStorage.setItem(c,C);}.bind(this));return Promise.resolve();},update:function(p){var c=a.createFlexObjectKey(p.flexObject);var C=JSON.stringify(p.flexObject);this.oStorage.setItem(c,C);return Promise.resolve();},reset:function(p){a.forEachChangeInStorage({storage:this.oStorage,reference:p.reference,layer:p.layer},function(f){if(s(p,f.changeDefinition)){this.oStorage.removeItem(f.key);}}.bind(this));return Promise.resolve();},remove:function(p){var c=a.createFlexObjectKey(p.flexObject);this.oStorage.removeItem(c);return Promise.resolve();},loadFeatures:function(){return Promise.resolve({});},getFlexInfo:function(p){p.storage=this.oStorage;return Promise.resolve({isResetEnabled:a.getAllFlexObjects(p).length>0});}});return b;},true);
