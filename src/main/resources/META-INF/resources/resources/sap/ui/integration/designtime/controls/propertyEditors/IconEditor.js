/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/integration/designtime/controls/propertyEditors/BasePropertyEditor","sap/ui/core/Fragment","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/IconPool"],function(B,F,J,a,b,I){"use strict";var c=B.extend("sap.ui.integration.designtime.controls.propertyEditors.IconEditor",{constructor:function(){B.prototype.constructor.apply(this,arguments);this._oIconModel=new J(I.getIconNames().map(function(n){return{name:n,path:"sap-icon://"+n};}));this._oInput=new sap.m.Input({value:"{value}",showSuggestion:true,showValueHelp:true,valueHelpRequest:this._handleValueHelp.bind(this)});this._oInput.setModel(this._oIconModel,"icons");this._oInput.bindAggregation("suggestionItems","icons>/",new sap.ui.core.ListItem({text:"{icons>path}",additionalText:"{icons>name}"}));this._oInput.attachLiveChange(function(e){this.firePropertyChanged(e.getParameter("value"));}.bind(this));this._oInput.attachSuggestionItemSelected(function(e){this.firePropertyChanged(e.getParameter("selectedItem").getText());}.bind(this));this.addContent(this._oInput);},renderer:B.getMetadata().getRenderer().render});c.prototype._handleValueHelp=function(e){var v=e.getSource().getValue();if(!this._oDialog){F.load({name:"sap.ui.integration.designtime.controls.propertyEditors.IconSelection",controller:this}).then(function(d){this._oDialog=d;this.addDependent(this._oDialog);this._oDialog.setModel(this._oIconModel);this._filter(v);this._oDialog.open(v);}.bind(this));}else{this._filter(v);this._oDialog.open(v);}};c.prototype.handleSearch=function(e){var v=e.getParameter("value");this._filter(v);};c.prototype._filter=function(v){var f=new a("path",b.Contains,v);var o=this._oDialog.getBinding("items");o.filter([f]);};c.prototype.handleClose=function(e){var s=e.getParameter("selectedItem");if(s){this.firePropertyChanged(s.getIcon());}e.getSource().getBinding("items").filter([]);};return c;});
