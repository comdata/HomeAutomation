/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/LrepConnector","sap/ui/fl/Cache","sap/ui/fl/Utils","sap/base/util/UriParameters","sap/base/Log"],function(L,C,U,a,b){"use strict";var S=function(s){if(!s){throw new Error("no flex settings provided");}if(!s.defaultLayerPermissions){s.defaultLayerPermissions={VENDOR:true,CUSTOMER_BASE:true,CUSTOMER:true,USER:false};}if(!s.developerModeLayerPermissions){s.developerModeLayerPermissions={VENDOR:true,CUSTOMER_BASE:true,CUSTOMER:false,USER:false};}if(!(S._IS_VARIANT_SHARING_ENABLED in s)){s.isVariantSharingEnabled=true;}this._oSettings=s;};S._initInstance=function(){var s;if(U.isTrialSystem()){s=new S({isKeyUser:true,isVariantSharingEnabled:false});}S._instance=s;};S._initInstance();S._IS_VARIANT_SHARING_ENABLED="isVariantSharingEnabled";S.attachEvent=function(e,c){S._oEventProvider.attachEvent(e,c);};S.detachEvent=function(e,c){S._oEventProvider.detachEvent(e,c);};S.getInstance=function(){if(S._instance){return Promise.resolve(S._instance);}var p=C.getFlexDataPromise();if(p){return p.then(function(f){var s={};if(f.changes&&f.changes.settings){s=f.changes.settings;return S._storeInstance(s);}return S._loadSettings();},function(){return S._loadSettings();});}return S._loadSettings();};S._loadSettings=function(){return L.createConnector().loadSettings().then(function(s){if(!s){b.error("The request for flexibility settings failed; A default response is generated and returned to consuming APIs");s={isKeyUser:false,isVariantSharingEnabled:false,isAtoAvailable:false,isAtoEnabled:false,isProductiveSystem:true,_bFlexChangeMode:false,_bFlexibilityAdaptationButtonAllowed:false};}return S._storeInstance(s);});};S._storeInstance=function(s){if(!S._instance){S._instance=new S(s);}return S._instance;};S.getInstanceOrUndef=function(){var s;if(S._instance){s=S._instance;}return s;};S.prototype._getBooleanProperty=function(p){var v=false;if(this._oSettings[p]){v=this._oSettings[p];}return v;};S.prototype.isKeyUser=function(){return this._getBooleanProperty("isKeyUser");};S.prototype.isModelS=function(){return this._getBooleanProperty("isAtoAvailable");};S.prototype.isAtoEnabled=function(){return this._getBooleanProperty("isAtoEnabled");};S.prototype.isAtoAvailable=function(){return this._getBooleanProperty("isAtoAvailable");};S.prototype.isProductiveSystem=function(){return this._getBooleanProperty("isProductiveSystem");};S.prototype.isVariantSharingEnabled=function(){return(this._oSettings.isVariantSharingEnabled===true);};S.prototype.getSystem=function(){return this._oSettings.system;};S.prototype.getClient=function(){return this._oSettings.client;};S.prototype.getDefaultLayerPermissions=function(){return this._oSettings.defaultLayerPermissions;};S.prototype.getDeveloperModeLayerPermissions=function(){return this._oSettings.developerModeLayerPermissions;};return S;},true);
