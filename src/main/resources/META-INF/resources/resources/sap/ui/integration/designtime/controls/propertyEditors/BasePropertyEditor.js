/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Control","./../utils/ObjectBinding","sap/ui/model/json/JSONModel","sap/base/util/ObjectPath","sap/m/Label"],function(C,O,J,a,L){"use strict";var B=C.extend("sap.ui.integration.designtime.controls.propertyEditors.BasePropertyEditor",{metadata:{properties:{"renderLabel":{type:"boolean",defaultValue:true},"config":{type:"any"}},aggregations:{"_label":{type:"sap.m.Label",visibility:"hidden",multiple:false},"content":{type:"sap.ui.core.Control"}},associations:{"editor":{type:"sap.ui.integration.designtime.BaseEditor",multiple:false}},events:{propertyChanged:{parameters:{path:{type:"string"},value:{type:"any"}}}}},constructor:function(){C.prototype.constructor.apply(this,arguments);this._oConfigModel=new J(this.getConfig());this._oConfigModel.setDefaultBindingMode("OneWay");this.setModel(this._oConfigModel);this.setBindingContext(this._oConfigModel.getContext("/"));},clone:function(){this.destroyContent();return C.prototype.clone.apply(this,arguments);},exit:function(){this._oConfigModel.destroy();if(this._oConfigBinding){this._oConfigBinding.destroy();}},setConfig:function(c){var r=this.setProperty("config",c);this._initialize();return r;},setModel:function(m,n){var r=C.prototype.setModel.apply(this,arguments);this._initialize();return r;},onValueChange:function(v){var c=this.getConfig();if(typeof c.value==="undefined"&&c.defaultValue){c.value=c.defaultValue;this._oConfigModel.checkUpdate();}},_initialize:function(){var c=this.getConfig();var j=this.getModel("_context");if(j&&c){if(c.path&&!c.value){c.value="{context>"+c.path+"}";}this._oConfigBinding=new O();this._oConfigBinding.setModel(j,"context");this._oConfigBinding.setBindingContext(j.getContext("/"),"context");this._oConfigBinding.setObject(c);this._oConfigModel.setData(c);this._oConfigModel.checkUpdate();this.onValueChange(c.value);this.bindProperty("visible","visible");this._oConfigBinding.attachChange(function(e){this._oConfigModel.checkUpdate();if(e.getParameter("path")==="value"){this.onValueChange(e.getParameter("value"));}}.bind(this));}},getEditor:function(){return sap.ui.getCore().byId(this.getAssociation("editor"));},getI18nProperty:function(n){return this.getModel("i18n").getProperty(n);},getLabel:function(){var l=this.getAggregation("_label");if(!l){l=new L({text:this.getConfig().label,design:"Bold"});this.setAggregation("_label",l);}return l;},renderer:function(r,p){r.openStart("div",p);r.openEnd();if(p.getRenderLabel()&&p.getLabel()){r.renderControl(p.getLabel());}p.getContent().forEach(function(c){r.renderControl(c);});r.close("div");},firePropertyChanged:function(v){this.fireEvent("propertyChanged",{path:this.getConfig().path,value:v});}});return B;});
