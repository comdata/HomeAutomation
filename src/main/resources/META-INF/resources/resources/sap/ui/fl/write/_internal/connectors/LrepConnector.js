/*
 * ! OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/merge","sap/ui/fl/write/connectors/BaseConnector","sap/ui/fl/apply/_internal/connectors/LrepConnector","sap/ui/fl/apply/_internal/connectors/Utils","sap/ui/fl/write/_internal/connectors/Utils","sap/ui/fl/Utils","sap/base/util/restricted/_pick"],function(m,B,A,a,W,F,_){"use strict";var R={FLEX_INFO:"/flex/info/",PUBLISH:"/actions/make_changes_transportable/",CHANGES:"/changes/",VARIANTS:"/variants/",SETTINGS:"/flex/settings"};var d=function(p){var r=p.isLegacyVariant?R.VARIANTS:R.CHANGES;var P=p.transport?{changelist:p.transport}:undefined;if(p.flexObject){p.fileName=p.flexObject.fileName;}var w=a.getUrl(r,p,P);delete p.fileName;var t=a.getUrl(R.SETTINGS,p);var o=W.getRequestOptions(A,t,p.flexObjects||p.flexObject,"application/json; charset=utf-8","json");return W.sendRequest(w,p.method,o);};var L=m({},B,{layers:["ALL"],reset:function(p){var P=["reference","layer","appVersion","changelist","generator"];var b=_(p,P);var c=F.getUrlParameter("sap-client");if(c){b["sap-client"]=c;}if(p.selectorIds){b.selector=p.selectorIds;}if(p.changeTypes){b.changeType=p.changeTypes;}delete p.reference;var D=a.getUrl(R.CHANGES,p,b);return a.sendRequest(D,"DELETE");},publish:function(p){var P=["reference","layer","appVersion","changelist","package"];var b=_(p,P);var c=F.getUrlParameter("sap-client");if(c){b["sap-client"]=c;}delete p.reference;var D=a.getUrl(R.PUBLISH,p,b);return a.sendRequest(D,"POST");},getFlexInfo:function(p){var P=["layer","appVersion"];var b=_(p,P);var c=F.getUrlParameter("sap-client");if(c){b["sap-client"]=c;}var D=a.getUrl(R.FLEX_INFO,p,b);return a.sendRequest(D);},loadFeatures:function(p){var P={};var c=F.getUrlParameter("sap-client");if(c){P["sap-client"]=c;}var f=a.getUrl(R.SETTINGS,p,P);return a.sendRequest(f);},write:function(p){p.method="POST";return d(p);},update:function(p){if(p.flexObject.fileType==="variant"){p.isLegacyVariant=true;}p.method="PUT";return d(p);},remove:function(p){var P={namespace:p.flexObject.namespace,layer:p.flexObject.layer};if(p.transport){P.changelist=p.transport;}p.fileName=p.flexObject.fileName;var D=a.getUrl(R.CHANGES,p,P);delete p.fileName;var t=a.getUrl(R.SETTINGS,p);var r=W.getRequestOptions(A,t,undefined,"application/json; charset=utf-8","json");return W.sendRequest(D,"DELETE",r);}});return L;},true);
