/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Renderer","./YearPicker","./YearPickerRenderer","./CalendarDate","sap/ui/core/date/UniversalDate","./CalendarUtils","sap/ui/thirdparty/jquery"],function(R,Y,a,C,U,b,q){"use strict";var c=Y.extend("sap.ui.unified.calendar.YearRangePicker",{metadata:{library:"sap.ui.unified",properties:{years:{type:"int",group:"Appearance",defaultValue:9},columns:{type:"int",group:"Appearance",defaultValue:3},rangeSize:{type:"int",group:"Appearance",defaultValue:20}}},renderer:R.extend(a)});c.prototype.setDate=function(d){var o,y,i,f;d&&b._checkJSDateObject(d);y=d.getFullYear();b._checkYearInValidRange(y);o=C.fromLocalJSDate(d,this.getPrimaryCalendarType());o.setMonth(0,1);this.setProperty("date",d,true);this.setProperty("year",o.getYear(),true);this._oDate=o;if(this.getDomRef()){i=this.getYears();f=new C(this._oDate,this.getPrimaryCalendarType());f.setYear(f.getYear()-Math.floor(i/2)*this.getRangeSize());f=this._checkFirstDate(f);this._updateYears(f,Math.floor(i/2));}return this;};c.prototype._checkFirstDate=function(d){var y=this.getYears();var m=new C(this._oMaxDate,this.getPrimaryCalendarType());m.setYear(m.getYear()-y*this.getRangeSize()+1);if(d.isAfter(m)&&d.getYear()!=m.getYear()){d=new C(m,this.getPrimaryCalendarType());d.setMonth(0,1);}else if(d.isBefore(this._oMinDate)&&d.getYear()!=this._oMinDate.getYear()){d=new C(this._oMinDate,this.getPrimaryCalendarType());d.setMonth(0,1);}return d;};c.prototype._updatePage=function(f,s,F){var d=this._oItemNavigation.getItemDomRefs(),o=C.fromLocalJSDate(this._oFormatYyyymmdd.parse(q(d[0]).attr("data-sap-year-start")),this.getPrimaryCalendarType()),y=this.getYears();if(f){var m=new C(this._oMaxDate,this.getPrimaryCalendarType());m.setYear(m.getYear()-y*this.getRangeSize()+1);if(o.isBefore(m)){o.setYear(o.getYear()+y*this.getRangeSize());o=this._checkFirstDate(o);}else{return;}}else{if(o.isAfter(this._oMinDate)){o.setYear(o.getYear()-y*this.getRangeSize());if(o.isBefore(this._oMinDate)){o=new C(this._oMinDate,this.getPrimaryCalendarType());}o=this._checkFirstDate(o);}else{return;}}this._updateYears(o,s);if(F){this.firePageChange();}};c.prototype._updateYears=function(f,s){var S=new C(this._getDate(),this.getPrimaryCalendarType()),F="",d="",o=new C(f,this.getPrimaryCalendarType()),D=this._oItemNavigation.getItemDomRefs(),y,$;S.setYear(S.getYear()+Math.floor(this.getRangeSize()/2));o.setYear(o.getYear()+this.getRangeSize()-1);for(var i=0;i<D.length;i++){y=this._oFormatYyyymmdd.format(f.toUTCJSDate(),true);$=q(D[i]);$.attr("id",this.getId()+"-y"+y);F=this._oYearFormat.format(U.getInstance(f.toUTCJSDate(),f.getCalendarType()),true);d=this._oYearFormat.format(U.getInstance(o.toUTCJSDate(),o.getCalendarType()),true);$.text(F+" - "+d);$.attr("data-sap-year-start",y);if($.hasClass("sapUiCalItemSel")){$.removeClass("sapUiCalItemSel");}$.removeAttr("aria-selected");if(b._isBetween(S,f,o,true)){s=i;}if(b._isBetween(this._oMinDate,f,o,true)||b._isBetween(this._oMaxDate,f,o,true)||this._oMinDate.isBefore(f)&&this._oMaxDate.isAfter(o)){$.removeClass("sapUiCalItemDsbl");$.removeAttr("aria-disabled");}else{$.addClass("sapUiCalItemDsbl");$.attr("aria-disabled",true);}f.setYear(o.getYear()+1);o.setYear(o.getYear()+this.getRangeSize());}this._oItemNavigation.focusItem(s);};c.prototype._selectYear=function(i){var d=this._oItemNavigation.getItemDomRefs(),D=q(d[i]),y=D.attr("data-sap-year-start"),o=C.fromLocalJSDate(this._oFormatYyyymmdd.parse(y),this.getPrimaryCalendarType());if(D.hasClass("sapUiCalItemDsbl")){return false;}this.setProperty("date",o.toLocalJSDate(),true);this.setProperty("year",o.getYear(),true);return true;};return c;});
