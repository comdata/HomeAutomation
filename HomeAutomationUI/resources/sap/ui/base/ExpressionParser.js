/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2015 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['jquery.sap.global','sap/ui/thirdparty/URI','jquery.sap.strings'],function(q,U){"use strict";
//License granted by Douglas Crockford to SAP, Apache License 2.0
//    (http://www.apache.org/licenses/LICENSE-2.0)
var u=f.bind(null,undefined),d={"Array":Array,"Boolean":Boolean,"Date":Date,"encodeURIComponent":encodeURIComponent,"Infinity":Infinity,"isFinite":isFinite,"isNaN":isNaN,"JSON":JSON,"Math":Math,"NaN":NaN,"Number":Number,"Object":Object,"odata":{"compare":function(){var O;q.sap.require("sap.ui.model.odata.ODataUtils");O=sap.ui.require("sap/ui/model/odata/ODataUtils");return O.compare.apply(O,arguments);},"fillUriTemplate":function(){if(!U.expand){q.sap.require("sap.ui.thirdparty.URITemplate");}return U.expand.apply(U,arguments).toString();},"uriEncode":function(){var O;q.sap.require("sap.ui.model.odata.ODataUtils");O=sap.ui.require("sap/ui/model/odata/ODataUtils");return O.formatValue.apply(O,arguments);}},"parseFloat":parseFloat,"parseInt":parseInt,"RegExp":RegExp,"String":String,"undefined":undefined},r=/\d/,a=/[a-z]\w*/i,b=/[a-z]/i,s={"BINDING":{led:k,nud:function(T,o){return B.bind(null,T.value);}},"IDENTIFIER":{led:k,nud:function(T,o){if(!(T.value in o.globals)){q.sap.log.warning("Unsupported global identifier '"+T.value+"' in expression parser input '"+o.input+"'",undefined,"sap.ui.base.ExpressionParser");}return f.bind(null,o.globals[T.value]);}},"CONSTANT":{led:k,nud:function(T,o){return f.bind(null,T.value);}},".":{lbp:18,led:function(T,o,L){return D.bind(null,L,o.advance("IDENTIFIER").value);},nud:k},"(":{lbp:17,led:function(T,o,L){var e=[],i=true;while(o.current().id!==")"){if(i){i=false;}else{o.advance(",");}e.push(o.expression(0));}o.advance(")");return F.bind(null,L,e);},nud:function(T,o){var v=o.expression(0);o.advance(")");return v;}},"[":{lbp:18,led:function(T,o,L){var n=o.expression(0);o.advance("]");return P.bind(null,L,n);},nud:function(T,o){var e=[],i=true;while(o.current().id!=="]"){if(i){i=false;}else{o.advance(",");}e.push(o.current().id===","?u:o.expression(0));}o.advance("]");return A.bind(null,e);}},"!":{lbp:15,led:k,nud:function(T,o){return g.bind(null,o.expression(this.lbp),function(x){return!x;});}},"typeof":{lbp:15,led:k,nud:function(T,o){return g.bind(null,o.expression(this.lbp),function(x){return typeof x;});}},"?":{lbp:4,led:function(T,o,L){var e,i;i=o.expression(this.lbp-1);o.advance(":");e=o.expression(this.lbp-1);return C.bind(null,L,i,e);},nud:k},")":{led:k,nud:k},"]":{led:k,nud:k},"{":{led:k,nud:function(T,o){var e=true,K,m={},v;while(o.current().id!=="}"){if(e){e=false;}else{o.advance(",");}if(o.current()&&o.current().id==="CONSTANT"&&typeof o.current().value==="string"){K=o.advance().value;}else{K=o.advance("IDENTIFIER").value;}o.advance(":");v=o.expression(0);m[K]=v;}o.advance("}");return M.bind(null,m);}},"}":{lbp:-1,led:k,nud:k},",":{led:k,nud:k},":":{led:k,nud:k}},t=["===","!==","!","||","&&",".","(",")","{","}",":",",","?","*","/","%","+","-","<=","<",">=",">","[","]"],c;t.forEach(function(T,i){t[i]=q.sap.escapeRegExp(T);});c=new RegExp(t.join("|"),"g");h("*",14,function(x,y){return x*y;});h("/",14,function(x,y){return x/y;});h("%",14,function(x,y){return x%y;});h("+",13,function(x,y){return x+y;}).nud=function(T,o){return g.bind(null,o.expression(this.lbp),function(x){return+x;});};h("-",13,function(x,y){return x-y;}).nud=function(T,o){return g.bind(null,o.expression(this.lbp),function(x){return-x;});};h("<=",11,function(x,y){return x<=y;});h("<",11,function(x,y){return x<y;});h(">=",11,function(x,y){return x>=y;});h(">",11,function(x,y){return x>y;});h("in",11,function(x,y){return x in y;});h("===",10,function(x,y){return x===y;});h("!==",10,function(x,y){return x!==y;});h("&&",7,function(x,y){return x&&y();},true);h("||",6,function(x,y){return x||y();},true);function A(e,m){var R=[];e.forEach(function(n,i){R[i]=n(m);});return R;}function B(i,e){return e[i];}function C(e,T,E,i){return e(i)?T(i):E(i);}function f(v){return v;}function D(L,i,e){var o=L(e),v=o[i];return typeof v==="function"?v.bind(o):v;}function F(L,e,m){var R=[];e.forEach(function(n,i){R[i]=n(m);});return L(m).apply(null,R);}function I(L,R,o,e,i){return o(L(i),e?R.bind(null,i):R(i));}function M(m,e){var K,R={};for(K in m){R[K]=m[K](e);}return R;}function P(L,n,e){return L(e)[n(e)];}function g(R,o,e){return o(R(e));}function h(i,e,o,L){s[i]={lbp:e,led:function(T,m,n){var v=L?this.lbp-1:this.lbp;return I.bind(null,n,m.expression(v),o,L);},nud:k};return s[i];}function j(m,i,e){var E=new SyntaxError(m);E.at=e;E.text=i;if(e!==undefined){m+=" at position "+e;}q.sap.log.error(m,i,"sap.ui.base.ExpressionParser");throw E;}function k(T){var e=T.input.slice(T.start,T.end);j("Unexpected "+T.id+(e!==T.id?": "+e:""),T.input,T.start+1);}function l(R,i,S){var m=[],t=[],T=q.sap._createJSTokenizer();function n(){var o,v,w,x,y;T.white();o=T.getCh();w=T.getIndex();if(b.test(o)){x=a.exec(i.slice(w));switch(x[0]){case"false":case"null":case"true":y={id:"CONSTANT",value:T.word()};break;case"in":case"typeof":y={id:x[0]};T.setIndex(w+x[0].length);break;default:y={id:"IDENTIFIER",value:x[0]};T.setIndex(w+x[0].length);}}else if(r.test(o)||o==="."&&r.test(i.charAt(T.getIndex()+1))){y={id:"CONSTANT",value:T.number()};}else if(o==="'"||o==='"'){y={id:"CONSTANT",value:T.string()};}else if(o==="$"){T.next("$");T.next("{");v=R(i,T.getIndex()-1);y={id:"BINDING",value:m.length};m.push(v.result);T.setIndex(v.at);}else{c.lastIndex=w;x=c.exec(i);if(!x||x.index!==w){return false;}y={id:x[0]};T.setIndex(w+x[0].length);}y.input=i;y.start=w;y.end=T.getIndex();t.push(y);return true;}T.init(i,S);try{while(n()){}}catch(e){if(e.name==="SyntaxError"){j(e.message,e.text,e.at);}else{throw e;}}return{at:T.getIndex(),parts:m,tokens:t};}function p(t,i,G){var e,n=0,o={advance:m,current:v,expression:w,globals:G,input:i},T;function m(E){var T=t[n];if(E){if(!T){j("Expected "+E+" but instead saw end of input",i);}else if(T.id!==E){j("Expected "+E+" but instead saw "+i.slice(T.start,T.end),i,T.start+1);}}n+=1;return T;}function v(){return t[n];}function w(x){var L;T=m();if(!T){j("Expected expression but instead saw end of input",i);}L=s[T.id].nud(T,o);while(n<t.length){T=v();if(x>=(s[T.id].lbp||0)){break;}m();L=s[T.id].led(T,o,L);}return L;}e=w(0);return{at:v()?v().start:undefined,formatter:e};}return{parse:function(R,i,S,G){var o,T;T=l(R,i,S);o=p(T.tokens,i,G||d);if(!T.parts.length){return{constant:o.formatter(),at:o.at||T.at};}function e(){return o.formatter(arguments);}e.textFragments=true;return{result:{formatter:e,parts:T.parts},at:o.at||T.at};}};},true);
