/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2015 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['jquery.sap.global','sap/ui/dt/ManagedObjectObserver'],function(q,M){"use strict";var C=M.extend("sap.ui.dt.ControlObserver",{metadata:{library:"sap.ui.dt",properties:{},associations:{"target":{"type":"sap.ui.core.Control"}},events:{"domChanged":{}}}});C.prototype.init=function(){M.prototype.init.apply(this,arguments);this._fnFireDomChanged=this.fireDomChanged.bind(this);this._oControlDelegate={onAfterRendering:this._onAfterRendering,onBeforeRendering:this._onBeforeRendering};};C.prototype.observe=function(c){M.prototype.observe.apply(this,arguments);q(window).on("resize",this._fnFireDomChanged);this._startMutationObserver();c.addEventDelegate(this._oControlDelegate,this);};C.prototype.unobserve=function(c){M.prototype.unobserve.apply(this,arguments);this._stopMutationObserver();q(window).off("resize",this._fnFireDomChanged);c.removeDelegate(this._oControlDelegate,this);};C.prototype._startMutationObserver=function(){var t=this;var a=window.MutationObserver||window.WebKitMutationObserver;var d=this.getTargetInstance().getDomRef();if(a&&d){this.oMutationObserver=new a(function(m){t.fireDomChanged();});this.oMutationObserver.observe(d,{childList:true,subtree:true,attributes:true});}};C.prototype._stopMutationObserver=function(){if(this.oMutationObserver){this.oMutationObserver.disconnect();this.oMutationObserver=null;}};C.prototype._onBeforeRendering=function(){this._stopMutationObserver();};C.prototype._onAfterRendering=function(){this._startMutationObserver();this.fireDomChanged();};return C;},true);
