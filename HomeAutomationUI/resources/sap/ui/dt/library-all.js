jQuery.sap.declare('sap.ui.dt.library-all');if(!jQuery.sap.isDeclared('sap.ui.dt.DesignTimeMetadata')){
/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2015 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
jQuery.sap.declare('sap.ui.dt.DesignTimeMetadata');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.ManagedObject');sap.ui.define("sap/ui/dt/DesignTimeMetadata",['jquery.sap.global','sap/ui/base/ManagedObject'],function(q,M){"use strict";var D=M.extend("sap.ui.dt.DesignTimeMetadata",{metadata:{library:"sap.ui.dt",properties:{data:{type:"object"}}}});D.prototype.setData=function(d){this.setProperty("data",this._ensureProperties(d));return this;};D.prototype._ensureProperties=function(d){return q.extend(true,{defaultSettings:{},aggregations:{layout:{visible:false}},properties:{},associations:{},events:{},behavior:{constructor:null,resize:{stop:null,grid:null,start:null,minWidth:null,minHeight:null,maxWidth:null,maxHeight:null}},renderer:null,css:null,name:null,description:"",keywords:[],draggable:true,selectable:true,removable:true,resizable:true,visible:true,needDelegateFromParent:false},d);};D.prototype.getName=function(){return this.getData().name;};D.prototype.hasAggregation=function(a){return!!this.getAggregations()[a];};D.prototype.getAggregation=function(a){return this.getAggregations()[a]||{};};D.prototype.getAggregations=function(){return this.getData().aggregations;};D.prototype.isVisible=function(){return this.getData().visible!==false;};D.prototype.isAggregationVisible=function(a){return this.getAggregation(a).visible!==false;};D.prototype.getAggregationDomRef=function(a){return this.getAggregation(a).domRef;};return D;},true);};if(!jQuery.sap.isDeclared('sap.ui.dt.ElementUtil')){jQuery.sap.declare('sap.ui.dt.ElementUtil');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/dt/ElementUtil",['jquery.sap.global'],function(q){"use strict";var E={};E.iterateOverAllPublicAggregations=function(e,c){var a=e.getMetadata().getAllAggregations();if(!a){c();}for(var n in a){var A=a[n];var v=this.getAggregation(e,n);c(A,v);}};E.getElementInstance=function(e){if(typeof e==="string"){return sap.ui.getCore().byId(e);}else{return e;}};E.hasAncestor=function(e,a){var p=e;while(p&&p!==a){p=p.getParent();}return!!p;};E.findAllPublicElements=function(e){var f=[];var t=this;var c=sap.ui.core;function a(e){if(!(e instanceof c.Element)){return;}if(e.getMetadata().getClass()===c.ComponentContainer){if(!e.getComponentInstance()){return;}a(e.getComponentInstance().getAggregation("rootControl"));}else{f.push(e);t.iterateOverAllPublicAggregations(e,function(A,v){if(v&&v.length){for(var i=0;i<v.length;i++){var o=v[i];a(o);}}else if(v instanceof c.Element){a(v);}});}}a(e);return f;};E.getDomRef=function(e){if(e){var d;if(e.getDomRef){d=e.getDomRef();}if(!d&&e.getRenderedDomRef){d=e.getRenderedDomRef();}return d;}};E.findAllPublicChildren=function(e){var f=this.findAllPublicElements(e);var i=f.indexOf(e);if(i>-1){f.splice(i,1);}return f;};E.isElementFiltered=function(c,t){var a=this;t=t||this.getControlFilter();var f=false;t.forEach(function(T){f=a.isInstanceOf(c,T);if(f){return false;}});return f;};E.findClosestControlInDom=function(n){if(n&&n.getAttribute("data-sap-ui")){return sap.ui.getCore().byId(n.getAttribute("data-sap-ui"));}else{if(n.parentNode){this.findClosestControlInDom(n.parentNode);}else{return null;}}};E.getAggregationMutators=function(e,a){var m=e.getMetadata();m.getJSONKeys();var A=m.getAggregation(a);return{get:A._sGetter,add:A._sMutator,remove:A._sRemoveMutator,insert:A._sInsertMutator};};E.getAggregation=function(e,a){var g=this.getAggregationMutators(e,a).get;var v=e[g]();v=v&&v.splice?v:(v?[v]:[]);return v;};E.addAggregation=function(p,a,e){var A=this.getAggregationMutators(p,a).add;p[A](e);};E.removeAggregation=function(p,a,e){var A=this.getAggregationMutators(p,a).remove;p[A](e);};E.insertAggregation=function(p,a,e,i){if(this.getAggregation(p,a).indexOf(e)!==-1){e.__bSapUiDtSupressParentChangeEvent=true;try{this.removeAggregation(p,a,e);}finally{delete e.__bSapUiDtSupressParentChangeEvent;}}var A=this.getAggregationMutators(p,a).insert;p[A](e,i);};E.isValidForAggregation=function(p,a,e){var A=p.getMetadata().getAggregation(a);return this.isInstanceOf(e,A.type);};E.isInstanceOf=function(e,t){var i=q.sap.getObject(t);if(typeof i==="function"){return e instanceof i;}else{return false;}};E.getDesignTimeMetadata=function(e){var d=e?e.getMetadata().getDesignTime():{};return d||{};};return E;},true);};if(!jQuery.sap.isDeclared('sap.ui.dt.ManagedObjectObserver')){jQuery.sap.declare('sap.ui.dt.ManagedObjectObserver');jQuery.sap.require('sap.ui.base.ManagedObject');sap.ui.define("sap/ui/dt/ManagedObjectObserver",['sap/ui/base/ManagedObject','sap/ui/dt/ElementUtil'],function(M,E){"use strict";var a=M.extend("sap.ui.dt.ManagedObjectObserver",{metadata:{"abstract":true,library:"sap.ui.dt",properties:{},associations:{target:{type:"sap.ui.base.ManagedObject"}},events:{modified:{parameters:{type:"string",value:"any",oldValue:"any",target:"sap.ui.core.Element"}},destroyed:{}}}});a.prototype.init=function(){};a.prototype.exit=function(){var t=this.getTargetInstance();if(t){this.unobserve(t);}};a.prototype.setTarget=function(t){var o=this.getTargetInstance();if(o){this.unobserve(o);}this.setAssociation("target",t);var T=this.getTargetInstance();if(T){this.observe(T);}return this;};a.prototype.observe=function(t){var b=this;t.attachEvent("_change",this.fireModified,this);var o=this._fnOriginalDestroy=t.destroy;var d=false;t.destroy=function(){if(d){return;}b.unobserve(t);var O=o.apply(this,arguments);b.fireDestroyed();return O;};this._fnOriginalBindProperty=t.bindProperty;t.bindProperty=function(){var O=b._fnOriginalBindProperty.apply(this,arguments);b.fireModified();return O;};this._fnOriginalUnBindProperty=t.unbindProperty;t.unbindProperty=function(){var O=b._fnOriginalUnBindProperty.apply(this,arguments);b.fireModified();return O;};this._fnOriginalBindAggregation=t.bindAggregation;t.bindAggregation=function(s){var O=b._fnOriginalBindAggregation.apply(this,arguments);b.fireModified();return O;};this._fnOriginalUnBindAggregation=t.unbindAggregation;t.unbindAggregation=function(s){var O=b._fnOriginalUnBindAggregation.apply(this,arguments);b.fireModified();return O;};this._fnOriginalSetParent=t.setParent;t.setParent=function(p,s,S){var f=false;if(!this._bInSetParent){f=true;this._bInSetParent=true;}var c=this.getParent();var O=b._fnOriginalSetParent.apply(this,arguments);if(f&&!this.__bSapUiDtSupressParentChangeEvent){this._bInSetParent=false;if(c!==p){b.fireModified({type:"setParent",value:p,oldValue:c,target:this});}}return O;};this._fnOriginalAddAggregation=t.addAggregation;t.addAggregation=function(s,O,S){b._bAddAggregationCall=true;var v=b._fnOriginalAddAggregation.apply(this,arguments);b.fireModified({type:"addAggregation",value:O,target:this});return v;};this._fnOriginalRemoveAggregation=t.removeAggregation;t.removeAggregation=function(s,O,S){var v=b._fnOriginalRemoveAggregation.apply(this,arguments);b.fireModified({type:"removeAggregation",value:O,target:this});return v;};this._fnOriginalInsertAggregation=t.insertAggregation;t.insertAggregation=function(s,O,i,S){b._bInsertAggregationCall=true;var v=b._fnOriginalInsertAggregation.apply(this,arguments);b.fireModified({type:"insertAggregation",value:O,target:this});return v;};this._fnOriginalRemoveAllAggregations=t.removeAllAggregations;t.removeAllAggregations=function(s,S){var r=this.getAggregation(s);var O=b._fnOriginalRemoveAllAggregations.apply(this,arguments);b.fireModified({type:"removeAllAggregations",value:r,target:this});return O;};this._fnOriginalDestroyAggregation=t.destroyAggregation;t.destroyAggregation=function(s,S){var r=this.getAggregation(s);var O=b._fnOriginalDestroyAggregation.apply(this,arguments);b.fireModified({type:"destroyAggregation",value:r,target:this});return O;};b._aOriginalAddMutators={};b._aOriginalInsertMutators={};var A=t.getMetadata().getAllAggregations();Object.keys(A).forEach(function(s){var c=A[s];var _=t[c._sMutator];b._aOriginalAddMutators[c.name]=_;t[c._sMutator]=function(O){b._bAddAggregationCall=false;var v=_.apply(this,arguments);if(!b._bAddAggregationCall){b.fireModified({type:"addAggregation",value:O,target:this});}return v;};var e=t[c._sInsertMutator];b._aOriginalInsertMutators[c.name]=e;t[c._sInsertMutator]=function(O,i){b._bInsertAggregationCall=false;var v=e.apply(this,arguments);if(!b._bInsertAggregationCall){b.fireModified({type:"insertAggregation",value:O,target:this});}return v;};});};a.prototype.unobserve=function(t){var b=this;t.destroy=this._fnOriginalDestroy;delete this._fnOriginalDestroy;t.bindProperty=this._fnOriginalBindProperty;delete this._fnOriginalBindProperty;t.unbindProperty=this._fnOriginalUnBindProperty;delete this._fnOriginalUnBindProperty;t.bindAggregation=this._fnOriginalBindAggregation;delete this._fnOriginalBindAggregation;t.unbindAggregation=this._fnOriginalUnBindAggregation;delete this._fnOriginalUnBindAggregation;t.setParent=this._fnOriginalSetParent;delete this._fnOriginalSetParent;t.addAggregation=this._fnOriginalAddAggregation;delete this._fnOriginalAddAggregation;t.removeAggregation=this._fnOriginalRemoveAggregation;delete this._fnOriginalRemoveAggregation;t.insertAggregation=this._fnOriginalInsertAggregation;delete this._fnOriginalInsertAggregation;t.removeAllAggregations=this._fnOriginalRemoveAllAggregations;delete this._fnOriginalRemoveAllAggregations;t.destroyAggregation=this._fnOriginalDestroyAggregation;delete this._fnOriginalDestroyAggregation;var A=t.getMetadata().getAllAggregations();Object.keys(A).forEach(function(s){var o=A[s];t[o._sMutator]=b._aOriginalAddMutators[o.name];t[o._sInsertMutator]=b._aOriginalInsertMutators[o.name];});delete this._aOriginalAddMutators;delete this._aOriginalInsertMutators;t.detachEvent("_change",this.fireModified,this);};a.prototype.getTargetInstance=function(){return sap.ui.getCore().byId(this.getTarget());};return a;},true);};if(!jQuery.sap.isDeclared('sap.ui.dt.OverlayRegistry')){jQuery.sap.declare('sap.ui.dt.OverlayRegistry');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/ui/dt/OverlayRegistry",["sap/ui/core/Element"],function(E){"use strict";var O={};var o={};O.getOverlay=function(e){var i=g(e);return o[i];};O.register=function(e,a){var i=g(e);o[i]=a;};O.deregister=function(e){var i=g(e);delete o[i];};O.hasOverlays=function(){return!jQuery.isEmptyObject(o);};function g(e){return(e instanceof E)?e.getId():e;}return O;},true);};if(!jQuery.sap.isDeclared('sap.ui.dt.OverlayUtil')){jQuery.sap.declare('sap.ui.dt.OverlayUtil');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/dt/OverlayUtil",['jquery.sap.global','sap/ui/dt/OverlayRegistry','sap/ui/dt/ElementUtil'],function(q,O,E){"use strict";var a={};a.getClosestOverlayFor=function(e){if(!e||!e.getParent){return null;}var p=e.getParent();var P=O.getOverlay(p);while(p&&!P){p=p.getParent();P=O.getOverlay(p);}return P;};a.getGeometry=function(g){var m,b,c,d;g.forEach(function(e){if(e){if(!m||e.position.left<m){m=e.position.left;}if(!c||e.position.top<c){c=e.position.top;}var r=e.position.left+e.size.width;if(!b||r>b){b=r;}var B=e.position.top+e.size.height;if(!d||B>d){d=B;}}});if(typeof m==="number"){return{size:{width:b-m,height:d-c},position:{left:m,top:c}};}};a.getClosestOverlayForType=function(t,o){while(o&&!E.isInstanceOf(o.getElementInstance(),t)){o=o.getParentElementOverlay();}return o;};a.getClosestScrollable=function(o){if(!o){return;}o=o.getParent();while(o&&o.isScrollable&&!o.isScrollable()){o=o.getParent();}return o&&o.isScrollable?o:null;};a.getFirstChildOverlay=function(o){if(!o){return;}var A=o.getAggregationOverlays();if(A.length>0){for(var i=0;i<A.length;i++){var b=A[i];var c=b.getChildren();if(c.length){return c[0];}}}};a.getLastChildOverlay=function(o){if(!o){return;}var A=o.getAggregationOverlays();if(A.length>0){for(var i=A.length-1;i>=0;i--){var b=A[i];var c=b.getChildren();if(c.length){return c[c.length-1];}}}};a.getNextSiblingOverlay=function(o){if(!o){return;}var p=o.getParentAggregationOverlay();if(p){var A=p.getChildren();var i=A.indexOf(o);if(i!==A.length-1){return A[i+1];}else{if(i===A.length-1){var P=o.getParentElementOverlay();A=P.getAggregationOverlays();for(i=A.indexOf(p)+1;i<A.length;i++){var b=A[i].getChildren();if(b.length){return b[0];}}}}}};a.getPreviousSiblingOverlay=function(o){if(!o){return;}var p=o.getParentAggregationOverlay();if(p){var A=p.getChildren();var i=A.indexOf(o);if(i>0){return A[i-1];}else{if(i===0){var P=o.getParentElementOverlay();A=P.getAggregationOverlays();for(i=A.indexOf(p)-1;i>=0;i--){var b=A[i].getChildren();if(b.length){return b[b.length-1];}}}}}};a.getNextOverlay=function(o){if(!o){return;}var f=this.getFirstChildOverlay(o);if(f){return f;}var n=this.getNextSiblingOverlay(o);if(n){return n;}do{o=o.getParentElementOverlay();n=this.getNextSiblingOverlay(o);}while(o&&!n);return n;};a.getPreviousOverlay=function(o){if(!o){return;}var p=o.getParentAggregationOverlay();if(!p){return;}var P=this.getPreviousSiblingOverlay(o);if(P){var l=P;do{P=l;l=this.getLastChildOverlay(P);}while(l);return P;}return o.getParentElementOverlay();};a.getRootOverlay=function(o){var p=o;do{o=p;p=o.getParentElementOverlay();}while(p);return o;};return a;},true);};if(!jQuery.sap.isDeclared('sap.ui.dt.Plugin')){jQuery.sap.declare('sap.ui.dt.Plugin');jQuery.sap.require('sap.ui.base.ManagedObject');sap.ui.define("sap/ui/dt/Plugin",['sap/ui/base/ManagedObject'],function(M){"use strict";var P=M.extend("sap.ui.dt.Plugin",{metadata:{"abstract":true,library:"sap.ui.dt",properties:{designTime:{type:"sap.ui.dt.DesignTime",multiple:false}},associations:{},events:{}}});P.prototype.init=function(){};P.prototype.exit=function(){this.setDesignTime(null);};P.prototype.setDesignTime=function(d){var o=this.getDesignTime();if(o){this._deregisterOverlays(o);o.detachEvent("overlayCreated",this._onOverlayCreated,this);}if(d){this._registerOverlays(d);d.attachEvent("overlayCreated",this._onOverlayCreated,this);}this.setProperty("designTime",d);return this;};P.prototype._registerOverlays=function(d){if(this.registerOverlay||this.registerAggregationOverlay){var o=d.getOverlays();o.forEach(this._callOverlayRegistrationMethods.bind(this));}};P.prototype._deregisterOverlays=function(d){if(this.deregisterOverlay||this.deregisterAggregationOverlay){var o=d.getOverlays();o.forEach(this._callOverlayDeregestrationMethods.bind(this));}};P.prototype._callOverlayRegistrationMethods=function(o){if(this.registerOverlay){this.registerOverlay(o);}if(this.registerAggregationOverlay){var a=o.getAggregationOverlays();a.forEach(this.registerAggregationOverlay.bind(this));}};P.prototype._callOverlayDeregestrationMethods=function(o){if(this.deregisterOverlay){this.deregisterOverlay(o);}if(this.deregisterAggregationOverlay){var a=o.getAggregationOverlays();a.forEach(this.deregisterAggregationOverlay.bind(this));}};P.prototype._onOverlayCreated=function(e){var o=e.getParameter("overlay");this._callOverlayRegistrationMethods(o);};return P;},true);};if(!jQuery.sap.isDeclared('sap.ui.dt.Preloader')){jQuery.sap.declare('sap.ui.dt.Preloader');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/ui/dt/Preloader",["sap/ui/core/Element"],function(E){"use strict";var P={aLoadedClasses:[]};P.load=function(e){var t=this;var q=[];e.forEach(function(v){var o=v;if(typeof o==="string"){o=jQuery.sap.getObject(o);}if(o&&o.getMetadata){var m=o.getMetadata();var c=m.getName?m.getName():null;var i=c&&t.aLoadedClasses.indexOf(c)!==-1;if(!i&&m.loadDesignTime){t.aLoadedClasses.push(c);q.push(m.loadDesignTime());}}});return Promise.all(q);};P.loadLibraries=function(l){var c=[];l.forEach(function(L){var m=jQuery.sap.getObject(L);for(var C in m){if(m.hasOwnProperty(C)){c.push(L+"."+C);}}});return this.load(c);};P.loadAllLibraries=function(){var l=[];var L=sap.ui.getCore().getLoadedLibraries();for(var s in L){if(L.hasOwnProperty(s)){l.push(s);}}return this.loadLibraries(l);};return P;},true);};if(!jQuery.sap.isDeclared('sap.ui.dt.RenderingUtil')){jQuery.sap.declare('sap.ui.dt.RenderingUtil');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/dt/RenderingUtil",['jquery.sap.global'],function(q){"use strict";var R={};R.renderOverlay=function(r,o,c){if(o.getDomRef()){this._triggerOnAfterRenderingWithoutRendering(r,o);return;}r.addClass("sapUiDtOverlay");r.addClass(c);r.write("<div");r.writeControlData(o);var a=o.getAggregationName&&o.getAggregationName();if(a){r.write("data-sap-ui-dt-aggregation='"+o.getAggregationName()+"'");}else{r.write("data-sap-ui-dt-for='"+o.getElementInstance().getId()+"'");}r.writeClasses();r.writeStyles();r.write(">");this._renderChildren(r,o);r.write("</div>");};R._renderChildren=function(r,o){var c=o.getChildren();c.forEach(function(C){r.renderControl(C);});};R._triggerOnAfterRenderingWithoutRendering=function(r,o){r.write("");this._renderChildren(r,o);};return R;},true);};if(!jQuery.sap.isDeclared('sap.ui.dt.library')){jQuery.sap.declare('sap.ui.dt.library');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.library');sap.ui.define("sap/ui/dt/library",['jquery.sap.global','sap/ui/core/library'],function(q){"use strict";sap.ui.getCore().initLibrary({name:"sap.ui.dt",version:"1.30.10",dependencies:["sap.ui.core"],types:["sap.ui.dt.SelectionMode"],interfaces:[],controls:[],elements:[]});sap.ui.dt.SelectionMode={Multi:"Multi",Single:"Single"};return sap.ui.dt;});};if(!jQuery.sap.isDeclared('sap.ui.dt.plugin.MouseSelection')){jQuery.sap.declare('sap.ui.dt.plugin.MouseSelection');sap.ui.define("sap/ui/dt/plugin/MouseSelection",['sap/ui/dt/Plugin'],function(P){"use strict";var M=P.extend("sap.ui.dt.plugin.MouseSelection",{metadata:{library:"sap.ui.dt",properties:{},associations:{},events:{}}});M.prototype.init=function(){P.prototype.init.apply(this,arguments);this._mEventDelegate={"onclick":this._onClick};};M.prototype.registerOverlay=function(o){o.setSelectable(true);o.addEventDelegate(this._mEventDelegate,o);};M.prototype.deregisterOverlay=function(o){o.removeEventDelegate(this._mEventDelegate,o);};M.prototype._onClick=function(e){this.setSelected(!this.getSelected());e.preventDefault();e.stopPropagation();};return M;},true);};if(!jQuery.sap.isDeclared('sap.ui.dt.AggregationOverlayRenderer')){jQuery.sap.declare('sap.ui.dt.AggregationOverlayRenderer');sap.ui.define("sap/ui/dt/AggregationOverlayRenderer",['sap/ui/dt/RenderingUtil'],function(R){"use strict";var A={};A.render=function(r,a){R.renderOverlay(r,a,"sapUiDtAggregationOverlay");};return A;},true);};if(!jQuery.sap.isDeclared('sap.ui.dt.ControlObserver')){jQuery.sap.declare('sap.ui.dt.ControlObserver');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/dt/ControlObserver",['jquery.sap.global','sap/ui/dt/ManagedObjectObserver'],function(q,M){"use strict";var C=M.extend("sap.ui.dt.ControlObserver",{metadata:{library:"sap.ui.dt",properties:{},associations:{"target":{"type":"sap.ui.core.Control"}},events:{"domChanged":{}}}});C.prototype.init=function(){M.prototype.init.apply(this,arguments);this._fnFireDomChanged=this.fireDomChanged.bind(this);this._oControlDelegate={onAfterRendering:this._onAfterRendering,onBeforeRendering:this._onBeforeRendering};};C.prototype.observe=function(c){M.prototype.observe.apply(this,arguments);q(window).on("resize",this._fnFireDomChanged);this._startMutationObserver();c.addEventDelegate(this._oControlDelegate,this);};C.prototype.unobserve=function(c){M.prototype.unobserve.apply(this,arguments);this._stopMutationObserver();q(window).off("resize",this._fnFireDomChanged);c.removeDelegate(this._oControlDelegate,this);};C.prototype._startMutationObserver=function(){var t=this;var a=window.MutationObserver||window.WebKitMutationObserver;var d=this.getTargetInstance().getDomRef();if(a&&d){this.oMutationObserver=new a(function(m){t.fireDomChanged();});this.oMutationObserver.observe(d,{childList:true,subtree:true,attributes:true});}};C.prototype._stopMutationObserver=function(){if(this.oMutationObserver){this.oMutationObserver.disconnect();this.oMutationObserver=null;}};C.prototype._onBeforeRendering=function(){this._stopMutationObserver();};C.prototype._onAfterRendering=function(){this._startMutationObserver();this.fireDomChanged();};return C;},true);};if(!jQuery.sap.isDeclared('sap.ui.dt.DOMUtil')){jQuery.sap.declare('sap.ui.dt.DOMUtil');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/dt/DOMUtil",['jquery.sap.global','sap/ui/dt/ElementUtil'],function(q,E){"use strict";var D={};D.getSize=function(d){return{width:d.offsetWidth,height:d.offsetHeight};};D.getOffsetFromParent=function(p,P,s,a){var o={left:p.left,top:p.top};if(P){o.left-=(P.left-(a?a:0));o.top-=(P.top-(s?s:0));}return o;};D.getZIndex=function(d){var z;var e=q(d);if(e.length){z=e.zIndex()||e.css("z-index");}return z;};D.getOverflows=function(d){var o;var e=q(d);if(e.length){o={};o.overflowX=e.css("overflow-x");o.overflowY=e.css("overflow-y");}return o;};D.getGeometry=function(d){if(d){return{domRef:d,size:this.getSize(d),position:q(d).offset()};}};D.syncScroll=function(s,t){var $=q(t);var T=$.scrollTop();var o=$.scrollLeft();var a=q(s);var S=a.scrollTop();var b=a.scrollLeft();if(S!==T){$.scrollTop(S);}if(b!==o){$.scrollLeft(b);}};D.getDomRefForCSSSelector=function(d,c){if(!c){return false;}if(c===":sap-domref"){return d;}if(c.indexOf(":sap-domref")>-1){return document.querySelector(c.replace(":sap-domref","#"+this.getEscapedString(d.id)));}return d?d.querySelector(c):undefined;};D.getEscapedString=function(s){return s.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,'\\$1');};D.setDraggable=function($,v){$.attr("draggable",v);};D.getComputedStyles=function(e){var c;if(typeof e.currentStyle!='undefined'){c=e.currentStyle;}else{c=document.defaultView.getComputedStyle(e);}return c;};D.copyComputedStyle=function(s,d){var S=this.getComputedStyles(s);for(var a in S){try{if(typeof a=="string"&&a!="cssText"&&!/\d/.test(a)&&a.indexOf("margin")===-1){d.style[a]=S[a];if(a=="font"){d.style.fontSize=S.fontSize;}}}catch(e){}}};D.copyComputedStylesForDOM=function(s,d){this.copyComputedStyle(s,d);for(var i=0;i<s.children.length;i++){this.copyComputedStylesForDOM(s.children[i],d.children[i]);}};D.cloneDOMAndStyles=function(n,t){var c=n.cloneNode(true);this.copyComputedStylesForDOM(n,c);var $=q(c);q(t).append($);var p=$.position();if(p.left){$.css("cssText","margin-left : "+-p.left+"px !important");}if(p.top){$.css("cssText","margin-top : "+-p.top+"px !important");}};return D;},true);};if(!jQuery.sap.isDeclared('sap.ui.dt.ElementOverlayRenderer')){jQuery.sap.declare('sap.ui.dt.ElementOverlayRenderer');sap.ui.define("sap/ui/dt/ElementOverlayRenderer",['sap/ui/dt/RenderingUtil'],function(R){"use strict";var O={};O.render=function(r,o){R.renderOverlay(r,o,"sapUiDtElementOverlay");};return O;},true);};if(!jQuery.sap.isDeclared('sap.ui.dt.Overlay')){jQuery.sap.declare('sap.ui.dt.Overlay');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('jquery.sap.dom');sap.ui.define("sap/ui/dt/Overlay",['jquery.sap.global','sap/ui/core/Control','sap/ui/dt/ElementUtil','sap/ui/dt/OverlayUtil','sap/ui/dt/DOMUtil','jquery.sap.dom'],function(q,C,E,O,D){"use strict";var o="overlay-container";var a;var b=C.extend("sap.ui.dt.Overlay",{metadata:{library:"sap.ui.dt",properties:{},associations:{element:{type:"sap.ui.core.Element"}},aggregations:{},events:{destroyed:{parameters:{}}}}});b.getOverlayContainer=function(){if(!a){a=q.sap.byId(o);if(!a.length){a=q("<div id='"+o+"'></div>").appendTo("body");}}return a.get(0);};b.removeOverlayContainer=function(){if(a){a.remove();}a=null;};b.prototype.init=function(){this.attachBrowserEvent("scroll",this._onScroll,this);};b.prototype._onChildRerenderedEmpty=function(){return true;};b.prototype.exit=function(){delete this._oDomRef;this.fireDestroyed();};b.prototype.onBeforeRendering=function(){if(this.hasFocus()){this._bRestoreFocus=true;}};b.prototype.onAfterRendering=function(){this._oDomRef=this.getDomRef();if(this._oDomRef){this._updateDom();}if(this._bRestoreFocus){delete this._bRestoreFocus;this.focus();}};b.prototype.getDomRef=function(){return this._oDomRef||C.prototype.getDomRef.apply(this,arguments);};b.prototype.getElementInstance=function(){return sap.ui.getCore().byId(this.getElement());};b.prototype.hasFocus=function(){return document.activeElement===this.getFocusDomRef();};b.prototype.applyStyles=function(){var g=this.getGeometry();if(g){var $=this.$();var c=this.getParent();var p=(c&&c instanceof b)?c.$().scrollTop():null;var P=(c&&c instanceof b)?c.$().scrollLeft():null;var m=(c&&c instanceof b)?c.$().offset():null;var d=D.getOffsetFromParent(g.position,m,p,P);var s=g.size;$.css("width",s.width+"px");$.css("height",s.height+"px");$.css("top",d.top+"px");$.css("left",d.left+"px");var z=D.getZIndex(g.domRef);if(z){$.css("z-index",z);}var e=D.getOverflows(g.domRef);if(e){if(e.overflowX){$.css("overflow-x",e.overflowX);}if(e.overflowY){$.css("overflow-y",e.overflowY);}var S=g.domRef.scrollHeight;var i=g.domRef.scrollWidth;if(S>s.height||i>s.width){this._oDummyScrollContainer=q("<div class='sapUiDtDummyScrollContainer' style='height: "+S+"px; width: "+i+"px;'></div>");this.$().append(this._oDummyScrollContainer);}D.syncScroll(g.domRef,this.getDomRef());}this.getChildren().forEach(function(f){f.applyStyles();});if(this._oDummyScrollContainer){this._oDummyScrollContainer.remove();delete this._oDummyScrollContainer;}}};b.prototype.getGeometry=function(){var d=this.getAssociatedDomRef();var g=D.getGeometry(d);if(!g){var c=[];this.getChildren().forEach(function(e){c.push(e.getGeometry());});g=O.getGeometry(c);}return g;};b.prototype._updateDom=function(){var g=this.getGeometry();var p=this.getParent();if(p){if(p.getDomRef){var P=p.getDomRef();if(P!==this.$().parent().get(0)){this.$().appendTo(P);}}else{var a=b.getOverlayContainer();if(a!==this.$().parent().get(0)){this.$().appendTo(a);}this.applyStyles();}}if(g&&this.isVisible()){this.$().show();}else{this.$().hide();}};b.prototype._onScroll=function(){var g=this.getGeometry();var d=g?g.domRef:null;if(d){D.syncScroll(this.$(),d);}};return b;},true);};if(!jQuery.sap.isDeclared('sap.ui.dt.Selection')){jQuery.sap.declare('sap.ui.dt.Selection');jQuery.sap.require('sap.ui.base.ManagedObject');sap.ui.define("sap/ui/dt/Selection",['sap/ui/base/ManagedObject','./library'],function(M){"use strict";var S=M.extend("sap.ui.dt.Selection",{metadata:{library:"sap.ui.dt",properties:{"mode":{type:"sap.ui.dt.SelectionMode",defaultValue:sap.ui.dt.SelectionMode.Single}},associations:{},aggregations:{},events:{"change":{parameters:{selection:{type:"sap.ui.dt.Overlay[]"}}}}}});S.prototype.init=function(){this._aSelection=[];};S.prototype.exit=function(){delete this._aSelection;};S.prototype.getSelection=function(){return this._aSelection;};S.prototype.set=function(o,s){if(s){this.add(o);}else{this.remove(o);}};S.prototype.add=function(o){this._syncSelectionWithMode();this._aSelection.push(o);this.fireChange({selection:this.getSelection()});};S.prototype.remove=function(o){this._syncSelectionWithMode();var i=this._aSelection.indexOf(o);if(i!==-1){this._aSelection.splice(i,1);}this.fireChange({selection:this.getSelection()});};S.prototype._isSingleMode=function(){return this.getMode()===sap.ui.dt.SelectionMode.Single;};S.prototype._syncSelectionWithMode=function(){if(this._isSingleMode()){this._aSelection.forEach(function(o){o.setSelected(false,true);});this._aSelection=[];}};return S;},true);};if(!jQuery.sap.isDeclared('sap.ui.dt.plugin.DragDrop')){jQuery.sap.declare('sap.ui.dt.plugin.DragDrop');sap.ui.define("sap/ui/dt/plugin/DragDrop",['sap/ui/dt/Plugin','sap/ui/dt/DOMUtil'],function(P,D){"use strict";var a=P.extend("sap.ui.dt.plugin.DragDrop",{metadata:{"abstract":true,library:"sap.ui.dt",properties:{},associations:{},events:{}}});a.prototype.init=function(){P.prototype.init.apply(this,arguments);this._oOverlayDelegate={"onAfterRendering":this._checkDraggable};};a.prototype.registerOverlay=function(o){o.addEventDelegate(this._oOverlayDelegate,this);o.attachEvent("draggableChange",this._onDraggableChange,this);if(o.isDraggable()){this._attachDragEvents(o);}o.attachBrowserEvent("dragover",this._onDragOver,this);o.attachBrowserEvent("dragenter",this._onDragEnter,this);};a.prototype.registerAggregationOverlay=function(A){A.attachDroppableChange(this._onAggregationDroppableChange,this);};a.prototype.deregisterOverlay=function(o){o.removeEventDelegate(this._oOverlayDelegate,this);o.detachEvent("draggableChange",this._onDraggableChange,this);this._detachDragEvents(o);o.detachBrowserEvent("dragover",this._onDragOver,this);o.detachBrowserEvent("dragenter",this._onDragEnter,this);};a.prototype.deregisterAggregationOverlay=function(A){A.detachDroppableChange(this._onAggregationDroppableChange,this);};a.prototype._attachDragEvents=function(o){o.attachBrowserEvent("dragstart",this._onDragStart,this);o.attachBrowserEvent("drag",this._onDrag,this);o.attachBrowserEvent("dragend",this._onDragEnd,this);};a.prototype._detachDragEvents=function(o){o.detachBrowserEvent("dragstart",this._onDragStart,this);o.detachBrowserEvent("dragend",this._onDragEnd,this);o.detachBrowserEvent("drag",this._onDrag,this);};a.prototype.onDraggableChange=function(e){};a.prototype.onDragStart=function(d,e){};a.prototype.onDragEnd=function(d,e){};a.prototype.onDrag=function(d,e){};a.prototype.onDragEnter=function(o,e){};a.prototype.onDragOver=function(o,e){};a.prototype.onAggregationDragEnter=function(A,e){};a.prototype.onAggregationDragOver=function(A,e){};a.prototype.onAggregationDragLeave=function(A,e){};a.prototype.onAggregationDrop=function(A,e){};a.prototype._checkDraggable=function(e){var o=e.srcControl;if(o.isDraggable()){D.setDraggable(o.$(),true);}};a.prototype._onDraggableChange=function(e){var o=e.getSource();if(o.isDraggable()){this._attachDragEvents(o);}else{this._detachDragEvents(o);}this.onDraggableChange(o,e);};a.prototype._onDragStart=function(e){var o=sap.ui.getCore().byId(e.currentTarget.id);this._oDraggedOverlay=o;e.stopPropagation();if(sap.ui.Device.browser.firefox&&e&&e.originalEvent&&e.originalEvent.dataTransfer&&e.originalEvent.dataTransfer.setData){e.originalEvent.dataTransfer.setData('text/plain','');}this.showGhost(o,e);this.onDragStart(o,e);};a.prototype.showGhost=function(o,e){var t=this;if(e&&e.originalEvent&&e.originalEvent.dataTransfer&&e.originalEvent.dataTransfer.setDragImage){this._$ghost=this.createGhost(o,e);this._$ghost.appendTo("body");setTimeout(function(){t._removeGhost();},0);e.originalEvent.dataTransfer.setDragImage(this._$ghost.get(0),e.originalEvent.pageX-this.getDraggedOverlay().$().offset().left,e.originalEvent.pageY-this.getDraggedOverlay().$().offset().top);}};a.prototype._removeGhost=function(){this.removeGhost();delete this._$ghost;};a.prototype.removeGhost=function(){var $=this.getGhost();if($){$.remove();}};a.prototype.createGhost=function(o){var g=o.getAssociatedDomRef();var $;if(!g){g=this._getAssociatedDomCopy(o);$=jQuery(g);}else{$=jQuery("<div></div>");D.cloneDOMAndStyles(g,$);}var b=jQuery("<div></div>").addClass("sapUiDtDragGhostWrapper");return b.append($.addClass("sapUiDtDragGhost"));};a.prototype._getAssociatedDomCopy=function(o){var t=this;var d=jQuery("<div></div>");o.getAggregationOverlays().forEach(function(A){A.getChildren().forEach(function(c){var C=c.getAssociatedDomRef();if(C){D.cloneDOMAndStyles(C,d);}else{D.cloneDOMAndStyles(t._getAssociatedDomCopy(c),d);}});});return d.get(0);};a.prototype.getGhost=function(){return this._$ghost;};a.prototype.getDraggedOverlay=function(){return this._oDraggedOverlay;};a.prototype._onDragEnd=function(e){var o=sap.ui.getCore().byId(e.currentTarget.id);this._removeGhost();this.onDragEnd(o,e);delete this._oDraggedOverlay;e.stopPropagation();};a.prototype._onDrag=function(e){var o=sap.ui.getCore().byId(e.currentTarget.id);this.onDrag(o,e);e.stopPropagation();};a.prototype._onDragEnter=function(e){var o=sap.ui.getCore().byId(e.currentTarget.id);var A=o.getParent();var i=A&&A.isDroppable&&A.isDroppable();if(i){if(!this.onDragEnter(o,e)){e.stopPropagation();}}e.preventDefault();};a.prototype._onDragOver=function(e){var o=sap.ui.getCore().byId(e.currentTarget.id);var A=o.getParent();var i=A&&A.isDroppable&&A.isDroppable();if(i){if(!this.onDragOver(o,e)){e.stopPropagation();}}e.preventDefault();};a.prototype._onAggregationDroppableChange=function(e){var A=e.getSource();var d=e.getParameter("droppable");if(d){this._attachAggregationOverlayEvents(A);}else{this._detachAggregationOverlayEvents(A);}};a.prototype._attachAggregationOverlayEvents=function(A){A.attachBrowserEvent("dragenter",this._onAggregationDragEnter,this);A.attachBrowserEvent("dragover",this._onAggregationDragOver,this);A.attachBrowserEvent("dragleave",this._onAggregationDragLeave,this);A.attachBrowserEvent("drop",this._onAggregationDrop,this);};a.prototype._detachAggregationOverlayEvents=function(A){A.detachBrowserEvent("dragenter",this._onAggregationDragEnter,this);A.detachBrowserEvent("dragover",this._onAggregationDragOver,this);A.detachBrowserEvent("dragleave",this._onAggregationDragLeave,this);A.detachBrowserEvent("drop",this._onAggregationDrop,this);};a.prototype._onAggregationDragEnter=function(e){var A=sap.ui.getCore().byId(e.currentTarget.id);this.onAggregationDragEnter(A,e);e.preventDefault();e.stopPropagation();};a.prototype._onAggregationDragOver=function(e){var A=sap.ui.getCore().byId(e.currentTarget.id);this.onAggregationDragOver(A,e);e.preventDefault();e.stopPropagation();};a.prototype._onAggregationDragLeave=function(e){var A=sap.ui.getCore().byId(e.currentTarget.id);this.onAggregationDragLeave(A,e);e.preventDefault();e.stopPropagation();};a.prototype._onAggregationDrop=function(e){var A=sap.ui.getCore().byId(e.currentTarget.id);this.onAggregationDrop(A,e);e.stopPropagation();};return a;},true);};if(!jQuery.sap.isDeclared('sap.ui.dt.AggregationOverlay')){jQuery.sap.declare('sap.ui.dt.AggregationOverlay');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/dt/AggregationOverlay",['jquery.sap.global','sap/ui/dt/Overlay','sap/ui/dt/DOMUtil','sap/ui/dt/ElementUtil','sap/ui/dt/OverlayUtil'],function(q,O,D,E,a){"use strict";var A=O.extend("sap.ui.dt.AggregationOverlay",{metadata:{library:"sap.ui.dt",properties:{aggregationName:{type:"string"},visible:{type:"boolean",defaultValue:true},droppable:{type:"boolean",defaultValue:false}},aggregations:{children:{type:"sap.ui.dt.Overlay",multiple:true}},events:{droppableChange:{parameters:{droppable:{type:"boolean"}}}}}});A.prototype.getAssociatedDomRef=function(){var o=this.getParent();var e=this.getElementInstance();var s=this.getAggregationName();var b=E.getDomRef(e);if(b){var d=o.getDesignTimeMetadata();var v=d.getAggregationDomRef(s);if(typeof v==="function"){return v.call(e,s);}else if(typeof v==="string"){return D.getDomRefForCSSSelector(b,v);}}};A.prototype.setDroppable=function(d){if(this.getDroppable()!==d){this.setProperty("droppable",d);this.toggleStyleClass("sapUiDtOverlayDroppable",d);this.fireDroppableChange({droppable:d});}return this;};A.prototype.isDroppable=function(){return this.getDroppable();};A.prototype.isVisible=function(){return this.getVisible();};A.prototype.getChildren=function(){return this.getAggregation("children")||[];};return A;},true);};if(!jQuery.sap.isDeclared('sap.ui.dt.ElementOverlay')){jQuery.sap.declare('sap.ui.dt.ElementOverlay');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/dt/ElementOverlay",['jquery.sap.global','sap/ui/dt/Overlay','sap/ui/dt/ControlObserver','sap/ui/dt/ManagedObjectObserver','sap/ui/dt/DesignTimeMetadata','sap/ui/dt/AggregationOverlay','sap/ui/dt/OverlayRegistry','sap/ui/dt/ElementUtil','sap/ui/dt/OverlayUtil','sap/ui/dt/DOMUtil'],function(q,O,C,M,D,A,a,E,b,c){"use strict";var d=O.extend("sap.ui.dt.ElementOverlay",{metadata:{library:"sap.ui.dt",properties:{visible:{type:"boolean",defaultValue:true},selected:{type:"boolean",defaultValue:false},selectable:{type:"boolean",defaultValue:false},draggable:{type:"boolean",defaultValue:false},editable:{type:"boolean",defaultValue:false}},aggregations:{designTimeMetadata:{type:"sap.ui.dt.DesignTimeMetadata",multiple:false},aggregationOverlays:{type:"sap.ui.dt.AggregationOverlay",multiple:true}},events:{selectionChange:{parameters:{selected:{type:"boolean"}}},draggableChange:{parameters:{draggable:{type:"boolean"}}},selectableChange:{parameters:{selectable:{type:"boolean"}}},editableChange:{parameters:{selected:{editable:"boolean"}}},elementModified:{parameters:{type:{type:"string"},value:{type:"any"},oldValue:{type:"any"},target:{type:"sap.ui.core.Element"}}}}}});d.prototype.init=function(){O.prototype.init.apply(this,arguments);this._oDefaultDesignTimeMetadata=null;this.placeAt(O.getOverlayContainer());this._bVisible=null;};d.prototype.exit=function(){O.prototype.exit.apply(this,arguments);this._destroyDefaultDesignTimeMetadata();var e=this.getElementInstance();if(e){a.deregister(e);this._unobserve(e);}else{a.deregister(this._elementId);}if(!a.hasOverlays()){O.removeOverlayContainer();}delete this._bVisible;delete this._elementId;};d.prototype.setElement=function(e){var o=this.getElementInstance();if(o instanceof sap.ui.core.Element){a.deregister(o);this._unobserve(o);}this.destroyAggregation("aggregationOverlays");this._destroyDefaultDesignTimeMetadata();delete this._elementId;this.setAssociation("element",e);this._createAggregationOverlays();var f=this.getElementInstance();this._elementId=f.getId();a.register(f,this);this._observe(f);var p=b.getClosestOverlayFor(f);if(p){p.sync();}return this;};O.prototype.getAssociatedDomRef=function(){return E.getDomRef(this.getElementInstance());};d.prototype.getVisible=function(){if(this._bVisible===null){return this.getDesignTimeMetadata().isVisible();}else{return this.getProperty("visible");}};d.prototype.setVisible=function(v){this.setProperty("visible",v);this._bVisible=v;return this;};d.prototype.setSelectable=function(s){if(s!==this.isSelectable()){if(!s){this.setSelected(false);}this.toggleStyleClass("sapUiDtOverlaySelectable",s);this.setProperty("selectable",s);this.fireSelectableChange({selectable:s});}return this;};d.prototype.setSelected=function(s,S){if(this.isSelectable()&&s!==this.isSelected()){this.setProperty("selected",s);this.toggleStyleClass("sapUiDtOverlaySelected",s);if(!S){this.fireSelectionChange({selected:s});}}return this;};d.prototype.setDraggable=function(e){if(this.getDraggable()!==e){this.toggleStyleClass("sapUiDtOverlayDraggable",e);this.setProperty("draggable",e);this.fireDraggableChange({draggable:e});}return this;};d.prototype.setEditable=function(e){if(this.getEditable()!==e){this.toggleStyleClass("sapUiDtOverlayEditable",e);this.setProperty("editable",e);this.fireEditableChange({editable:e});}return this;};d.prototype.getDesignTimeMetadata=function(){var o=this.getAggregation("designTimeMetadata");if(!o&&!this._oDefaultDesignTimeMetadata){this._oDefaultDesignTimeMetadata=new D({data:E.getDesignTimeMetadata(this.getElementInstance())});}return o||this._oDefaultDesignTimeMetadata;};d.prototype.sync=function(){var t=this;var e=this.getAggregationOverlays();e.forEach(function(o){t._syncAggregationOverlay(o);});};d.prototype._createAggregationOverlays=function(){var e=this.getElementInstance();var o=this.getDesignTimeMetadata();if(e){var t=this;E.iterateOverAllPublicAggregations(e,function(f,g){var s=f.name;var h=new A({aggregationName:s,element:e,visible:o.isAggregationVisible(s)});t._syncAggregationOverlay(h);t.addAggregation("aggregationOverlays",h);});}};d.prototype._destroyDefaultDesignTimeMetadata=function(){if(this._oDefaultDesignTimeMetadata){this._oDefaultDesignTimeMetadata.destroy();this._oDefaultDesignTimeMetadata=null;}};d.prototype._observe=function(e){if(e instanceof sap.ui.core.Control){this._oObserver=new C({target:e});this._oObserver.attachDomChanged(this._onElementDomChanged,this);}else{this._oObserver=new M({target:e});}this._oObserver.attachModified(this._onElementModified,this);this._oObserver.attachDestroyed(this._onElementDestroyed,this);};d.prototype._unobserve=function(e){this._oObserver.destroy();};d.prototype._syncAggregationOverlay=function(o){var s=o.getAggregationName();var e=E.getAggregation(this.getElementInstance(),s);e.forEach(function(f){var g=a.getOverlay(f);if(g){o.addChild(g);}});};d.prototype._onElementModified=function(e){this.sync();this.invalidate();this.fireElementModified(e.getParameters());};d.prototype._onElementDomChanged=function(){this.invalidate();};d.prototype._onElementDestroyed=function(){this.destroy();};d.prototype.getAggregationOverlays=function(){return this.getAggregation("aggregationOverlays")||[];};d.prototype.getChildren=function(){return this.getAggregationOverlays();};d.prototype.getAggregationOverlay=function(s){var e=this.getAggregationOverlays().filter(function(o){return o.getAggregationName()===s;});if(e.length){return e[0];}};d.prototype.getParentElementOverlay=function(){var p=this.getParentAggregationOverlay();if(p){return p.getParent();}};d.prototype.getParentAggregationOverlay=function(){var p=this.getParent();return p instanceof sap.ui.dt.AggregationOverlay?p:null;};d.prototype.isSelected=function(){return this.getSelected();};d.prototype.isSelectable=function(){return this.getSelectable();};d.prototype.isDraggable=function(){return this.getDraggable();};d.prototype.isEditable=function(){return this.getEditable();};d.prototype.isVisible=function(){return this.getVisible();};return d;},true);};if(!jQuery.sap.isDeclared('sap.ui.dt.plugin.ControlDragDrop')){jQuery.sap.declare('sap.ui.dt.plugin.ControlDragDrop');sap.ui.define("sap/ui/dt/plugin/ControlDragDrop",['sap/ui/dt/plugin/DragDrop','sap/ui/dt/ElementUtil','sap/ui/dt/DOMUtil'],function(D,E,a){"use strict";var C=D.extend("sap.ui.dt.plugin.ControlDragDrop",{metadata:{library:"sap.ui.dt",properties:{draggableTypes:{type:"string[]",defaultValue:["sap.ui.core.Element"]}},associations:{},events:{}}});C.prototype.registerOverlay=function(o){D.prototype.registerOverlay.apply(this,arguments);var e=o.getElementInstance();if(this.isDraggableType(e)&&this.checkDraggable(o)){o.setDraggable(true);}if(this.oDraggedElement){this._activateValidDroppablesFor(o);}};C.prototype._getDraggableTypes=function(){return this.getProperty("draggableTypes")||[];};C.prototype.isDraggableType=function(e){var d=this._getDraggableTypes();return d.some(function(t){return E.isInstanceOf(e,t);});};C.prototype.checkDraggable=function(o){return true;};C.prototype.deregisterOverlay=function(o){D.prototype.deregisterOverlay.apply(this,arguments);o.setDraggable(false);if(this.oDraggedElement){this._deactivateDroppablesFor(o);}};C.prototype.onDragStart=function(o,e){this._activateAllValidDroppables();};C.prototype.onDragEnd=function(o){delete this._oPreviousTarget;this._deactivateAllDroppables();};C.prototype.onDragEnter=function(t,e){if(t.getElementInstance()!==this.getDraggedOverlay().getElementInstance()&&t!==this._oPreviousTarget){this._repositionOn(t);}this._oPreviousTarget=t;};C.prototype.onAggregationDragEnter=function(A){delete this._oPreviousTarget;var t=A.getElementInstance();var d=this.getDraggedOverlay().getElementInstance();var s=this.getDraggedOverlay().getParentElementOverlay();var S;if(s){S=s.getElementInstance();}if(t!==S){var b=A.getAggregationName();E.addAggregation(t,b,d);}};C.prototype._activateAllValidDroppables=function(){this._iterateAllAggregations(this._activateValidDroppable.bind(this));};C.prototype._activateValidDroppable=function(A){if(this.checkDroppable(A)){A.setDroppable(true);}};C.prototype.checkDroppable=function(A){var p=A.getElementInstance();var d=this.getDraggedOverlay().getElementInstance();var s=A.getAggregationName();if(E.isValidForAggregation(p,s,d)){return true;}};C.prototype._deactivateDroppable=function(A){A.setDroppable(false);};C.prototype._activateValidDroppablesFor=function(o){this._iterateOverlayAggregations(o,this._activateValidDroppable.bind(this));};C.prototype._deactivateDroppablesFor=function(o){this._iterateOverlayAggregations(o,this._deactivateDroppable.bind(this));};C.prototype._deactivateAllDroppables=function(){this._iterateAllAggregations(function(A){A.setDroppable(false);});};C.prototype._iterateAllAggregations=function(s){var t=this;var d=E.getElementInstance(this.getDesignTime());var o=d.getOverlays();o.forEach(function(O){t._iterateOverlayAggregations(O,s);});};C.prototype._iterateOverlayAggregations=function(o,s){var A=o.getAggregationOverlays();A.forEach(function(b){s(b);});};C.prototype._repositionOn=function(t){var d=this.getDraggedOverlay().getElementInstance();var T=t.getElementInstance();var p=t.getParentElementOverlay().getElementInstance();var P=t.getParentAggregationOverlay().getAggregationName();var c=E.getAggregation(p,P);var i=c.indexOf(T);if(i!==-1){E.insertAggregation(p,P,d,i);}};return C;},true);};if(!jQuery.sap.isDeclared('sap.ui.dt.DesignTime')){jQuery.sap.declare('sap.ui.dt.DesignTime');jQuery.sap.require('sap.ui.base.ManagedObject');sap.ui.define("sap/ui/dt/DesignTime",['sap/ui/base/ManagedObject','sap/ui/dt/ElementOverlay','sap/ui/dt/OverlayRegistry','sap/ui/dt/Selection','sap/ui/dt/DesignTimeMetadata','sap/ui/dt/ElementUtil','./library'],function(M,E,O,S,D,a){"use strict";var b=M.extend("sap.ui.dt.DesignTime",{metadata:{library:"sap.ui.dt",properties:{selectionMode:{type:"sap.ui.dt.SelectionMode",defaultValue:sap.ui.dt.SelectionMode.Single},designTimeMetadata:{type:"object"}},associations:{rootElements:{type:"sap.ui.core.Element",multiple:true}},aggregations:{plugins:{type:"sap.ui.dt.Plugin",multiple:true}},events:{overlayCreated:{parameters:{ElementOverlay:{type:"sap.ui.dt.ElementOverlay"}}},overlayDestroyed:{parameters:{ElementOverlay:{type:"sap.ui.dt.ElementOverlay"}}},selectionChange:{parameters:{selection:{type:"sap.ui.dt.ElementOverlay[]"}}}}}});b.prototype.init=function(){this._oSelection=this.createSelection();this._oSelection.attachEvent("change",function(e){this.fireSelectionChange({selection:e.getParameter("selection")});},this);};b.prototype.exit=function(){this._destroyAllOverlays();this._oSelection.destroy();};b.prototype.createSelection=function(){return new S();};b.prototype.getSelection=function(){return this._oSelection.getSelection();};b.prototype.setSelectionMode=function(m){this.setProperty("selectionMode",m);this._oSelection.setMode(m);return this;};b.prototype.getPlugins=function(){return this.getAggregation("plugins")||[];};b.prototype.addPlugin=function(p){p.setDesignTime(this);this.addAggregation("plugins",p);return this;};b.prototype.insertPlugin=function(p,i){p.setDesignTime(this);this.insertAggregation("plugins",p,i);return this;};b.prototype.removePlugin=function(p){this.getPlugins().forEach(function(c){if(c===p){p.setDesignTime(null);return;}});this.removeAggregation("plugins",p);return this;};b.prototype.removeAllPlugins=function(){this.getPlugins().forEach(function(p){p.setDesignTime(null);});this.removeAllAggregation("plugins");return this;};b.prototype.getRootElements=function(){return this.getAssociation("rootElements")||[];};b.prototype.getDesignTimeMetadata=function(){return this.getProperty("designTimeMetadata")||{};};b.prototype.getDesignTimeMetadataFor=function(e){var c=e;var d=this.getDesignTimeMetadata();if(e.getMetadata){c=e.getMetadata()._sClassName;}return d[c];};b.prototype.addRootElement=function(r){this.addAssociation("rootElements",r);this.createOverlayFor(a.getElementInstance(r));return this;};b.prototype.removeRootElement=function(r){this.removeAssociation("rootElements",r);this._destroyOverlaysForElement(a.getElementInstance(r));return this;};b.prototype.removeAllRootElement=function(){this.removeAssociation("rootElements");this._destroyAllOverlays();return this;};b.prototype.createOverlay=function(e,d){return new E({element:e,designTimeMetadata:d?new D({data:d}):null});};b.prototype.getOverlays=function(){var o=[];this._iterateAllElements(function(e){var c=O.getOverlay(e);if(c){if(o.indexOf(c)===-1){o.push(c);}}});return o;};b.prototype._createOverlay=function(e){if(!O.getOverlay(e)){var m=this.getDesignTimeMetadataFor(e);var d=a.getDesignTimeMetadata(e);jQuery.extend(true,d,m);d=d!=={}?d:null;var o=this.createOverlay(e,d);o.attachEvent("elementModified",this._onElementModified,this);o.attachEvent("destroyed",this._onOverlayDestroyed,this);o.attachEvent("selectionChange",this._onOverlaySelectionChange,this);this.fireOverlayCreated({overlay:o});return o;}};b.prototype.createOverlayFor=function(r){var t=this;var R;this._iterateRootElementPublicChildren(r,function(e){var o=t._createOverlay(e);R=R||o;});return R;};b.prototype._destroyOverlaysForElement=function(r){this._iterateRootElementPublicChildren(r,function(e){var o=O.getOverlay(e);if(o){o.destroy();}});};b.prototype._destroyAllOverlays=function(){var t=this;this._iterateRootElements(function(r){t._destroyOverlaysForElement(r);});};b.prototype._onOverlayDestroyed=function(e){var o=e.getSource();if(o.getSelected()){this._oSelection.remove(o);}this.fireOverlayDestroyed({overlay:o});};b.prototype._onOverlaySelectionChange=function(e){var o=e.getSource();var s=e.getParameter("selected");this._oSelection.set(o,s);};b.prototype._onElementModified=function(e){var p=e.getParameters();if(p.type==="addAggregation"||p.type==="insertAggregation"){this._onOverlayElementAddAggregation(p.value);}else if(p.type==="setParent"){this._onOverlayElementSetParent(p.target,p.value);}};b.prototype._onOverlayElementAddAggregation=function(e){var o=O.getOverlay(e);if(!o){this.createOverlayFor(e);}};b.prototype._onOverlayElementSetParent=function(e,p){var o=O.getOverlay(e);if(o&&!this._isElementInRootElements(e)){o.destroy();}};b.prototype._isElementInRootElements=function(e){var f=false;this._iterateRootElements(function(r){if(a.hasAncestor(e,r)){f=true;return false;}});return f;};b.prototype._iterateRootElements=function(s){var r=this.getRootElements();r.forEach(function(R){var o=a.getElementInstance(R);s(o);});};b.prototype._iterateRootElementPublicChildren=function(r,s){var A=a.findAllPublicElements(r);A.forEach(function(e){s(e);});};b.prototype._iterateAllElements=function(s){var t=this;this._iterateRootElements(function(r){t._iterateRootElementPublicChildren(r,s);});};return b;},true);};
